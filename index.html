<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Manutenção de Equipamentos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <style>
        :root {
            --primary-color: #0d6efd;
            --secondary-color: #6c757d;
            --success-color: #198754;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #0dcaf0;
        }

        body {
            background-color: #f5f5f5;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding-bottom: 40px; /* Espaço para o rodapé */
        }

        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .navbar-brand {
            font-weight: bold;
            font-size: 1.4rem;
            color: white !important;
        }

        .card {
            border-radius: 8px;
            border: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }

        .card-header {
            background-color: #f8f9fa;
            border-bottom: 1px solid #eee;
            padding: 15px 20px;
            font-weight: bold;
            border-radius: 8px 8px 0 0 !important;
        }

        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-success {
            background-color: var(--success-color);
            border-color: var(--success-color);
        }

        .btn-danger {
            background-color: var(--danger-color);
            border-color: var(--danger-color);
        }

        .list-group-item {
            border-left: none;
            border-right: none;
            padding: 15px 20px;
        }

        .status-badge {
            font-size: 0.8em;
            padding: 5px 10px;
            border-radius: 20px;
        }

        .checklist-item {
            margin-bottom: 15px;
            border: 1px solid #eee;
            border-radius: 5px;
            padding: 10px;
        }

        .checklist-title {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .image-preview {
            max-width: 100%;
            height: auto;
            object-fit: cover;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .image-container {
            display: inline-block;
            margin: 5px;
            position: relative;
        }

        .image-container img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 5px;
            border: 1px solid #ddd;
            cursor: pointer; /* Para indicar que é clicável */
        }

        .image-container .delete-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: rgba(255, 0, 0, 0.7); /* Vermelho para destaque */
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            padding: 0;
            font-size: 14px;
            line-height: 1;
        }
        .image-container .delete-btn:hover {
             background-color: rgba(255, 0, 0, 0.9);
        }

        /* Botão de anotação */
        .image-container .btn-annotate {
             position: absolute;
             top: 5px;
             left: 5px; /* Ajustado para esquerda */
             background-color: rgba(0, 123, 255, 0.7); /* Azul */
             color: white;
             border-radius: 50%;
             width: 25px;
             height: 25px;
             display: flex;
             align-items: center;
             justify-content: center;
             cursor: pointer;
             border: none;
             padding: 0;
             font-size: 12px; /* Ícone menor */
             line-height: 1;
        }
        .image-container .btn-annotate:hover {
             background-color: rgba(0, 123, 255, 0.9);
        }


        /* Status colors */
        .status-aguardando {
            background-color: #fff3cd !important; /* Use !important se necessário para sobrescrever BS */
            color: #856404 !important;
        }

        .status-em-manutencao {
            background-color: #cce5ff !important;
            color: #004085 !important;
        }

        .status-concluido {
            background-color: #d4edda !important;
            color: #155724 !important;
        }

        .status-disponivel {
            background-color: #d1e7dd !important;
            color: #0f5132 !important;
        }

        /* Dashboard */
        .stat-card {
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
            min-height: 120px;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card .stat-title {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .stat-card .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .recent-activity {
            max-height: 400px;
            overflow-y: auto;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
            flex-shrink: 0; /* Evita que encolha */
        }

        /* Mobile Optimization */
        @media (max-width: 768px) {
            .card-body {
                padding: 15px;
            }

            .container {
                padding-left: 10px;
                padding-right: 10px;
            }

            .btn {
                padding: 0.375rem 0.75rem;
                font-size: 0.9rem; /* Ajuste opcional */
            }
             .btn-sm { /* Ajuste específico para botões pequenos */
                padding: 0.25rem 0.5rem;
                font-size: 0.8rem;
            }


            .stat-card {
                padding: 10px;
                min-height: 100px;
            }

            .stat-card .stat-value {
                font-size: 1.5rem;
            }

            .image-container img {
                width: 100px;
                height: 100px;
            }
            .navbar-nav {
                text-align: center; /* Centraliza itens no mobile */
            }
             /* Ajuste tabela no mobile */
            .table thead {
                 display: none; /* Esconde cabeçalho tradicional */
            }
            .table, .table tbody, .table tr, .table td {
                display: block;
                width: 100%;
            }
            .table tr {
                margin-bottom: 1rem;
                border: 1px solid #dee2e6;
                border-radius: .25rem;
            }
            .table td {
                text-align: right; /* Alinha valor à direita */
                padding-left: 50%; /* Espaço para label */
                position: relative;
                border-top: none; /* Remove borda superior padrão da célula */
                border-bottom: 1px solid #dee2e6; /* Adiciona borda inferior */
            }
             .table td:last-child {
                 border-bottom: none; /* Remove borda da última célula */
            }
            .table td::before {
                content: attr(data-label); /* Pega o label do data attribute */
                position: absolute;
                left: .5rem; /* Posição do label */
                width: 45%; /* Largura do label */
                padding-right: .5rem;
                text-align: left; /* Alinha label à esquerda */
                font-weight: bold;
            }
             /* Remove pseudo-elementos onde não faz sentido (ex: ações) */
            .table td:last-child::before {
                 content: "";
            }
             /* Garante que botões de ação fiquem visíveis */
             .table td:last-child {
                 text-align: center; /* Centraliza botões */
                 padding-left: 0; /* Remove padding esquerdo */
            }
        }

        /* Camera styles */
        .camera-container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            position: relative;
        }

        /* Corrigido: Assegura que o ID seja aplicado */
        #camera-preview-pre, #camera-preview-pos, #camera-modal-preview {
            width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 10px;
            background-color: #333; /* Fundo escuro para vídeo */
        }


        .camera-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        /* Anotação */
         #annotation-container {
             overflow: auto; /* Permite scroll se a imagem for grande */
             max-height: 60vh; /* Limita altura no modal */
             text-align: center; /* Centraliza a imagem/canvas */
             background-color: #f0f0f0; /* Fundo para melhor visualização */
             padding: 10px;
             border-radius: 5px;
         }
        /* Corrigido: Assegura que o ID seja aplicado */
        #annotation-canvas {
             cursor: crosshair;
             /* Estilos de posição e display são aplicados via JS */
        }

        .annotation-controls .btn.active {
             background-color: var(--primary-color);
             color: white;
        }

        /* Footer */
        .footer-dev {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #f8f9fa; /* Cor de fundo suave */
            padding: 5px 0;
            text-align: center;
            font-size: 0.8em;
            color: #6c757d; /* Cinza secundário */
            border-top: 1px solid #dee2e6;
            z-index: 1000; /* Garante que fique acima de outros elementos */
        }

        /* Outros ajustes */
        .checklist-item .btn-group .btn {
             padding: 0.25rem 0.5rem; /* Menor padding nos botões do checklist */
             font-size: 0.8rem; /* Fonte menor */
        }
        .checklist-item .btn-group .btn i {
             margin-right: 3px !important; /* Espaço menor para ícone */
        }

        /* Classe para indicar loading de imagem */
        .image-loading {
            background-color: #f8f9fa; /* Fundo suave */
            border: 1px dashed #ced4da; /* Borda tracejada */
        }

        /* Ajuste de estilo para os previews de imagem */
        .photo-preview-img {
            max-width: 150px; /* Garante tamanho consistente */
            max-height: 150px;
            object-fit: cover;
            margin: 5px; /* Adiciona margem entre as imagens */
            vertical-align: top; /* Alinha melhor com outros elementos inline-block */
        }

    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-tools me-2"></i>Sistema de Manutenção
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" id="nav-dashboard">
                            <i class="bi bi-speedometer2 me-1"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-lista">
                            <i class="bi bi-list-ul me-1"></i>Lista
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-novo">
                            <i class="bi bi-plus-circle me-1"></i>Nova Manutenção
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-ferramentas">
                            <i class="bi bi-tools me-1"></i>Ferramentas
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div id="conteudo-principal">

            <!-- Tela Dashboard -->
            <div id="tela-dashboard" class="view-content">
                <h2 class="mb-4">Dashboard de Manutenções</h2>

                <div class="row mb-4">
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card bg-light">
                            <div class="stat-title">Equipamentos</div>
                            <div class="stat-value" id="total-equipamentos">0</div>
                            <div>Total cadastrado</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card bg-light">
                            <div class="stat-title">Aguardando</div>
                            <div class="stat-value text-warning" id="total-aguardando">0</div>
                            <div>Manutenções pendentes</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card bg-light">
                            <div class="stat-title">Em Manutenção</div>
                            <div class="stat-value text-primary" id="total-em-manutencao">0</div>
                            <div>Em andamento</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card bg-light">
                            <div class="stat-title">Concluídas</div>
                            <div class="stat-value text-success" id="total-concluidas">0</div>
                            <div>Finalizadas</div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="bi bi-wrench me-2"></i>Manutenções Recentes
                            </div>
                            <div class="card-body p-0">
                                <ul class="list-group list-group-flush" id="manutencoes-recentes">
                                    <!-- Itens serão adicionados via JS -->
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="bi bi-activity me-2"></i>Atividade Recente
                            </div>
                            <div class="card-body p-0 recent-activity">
                                <ul class="list-group list-group-flush" id="atividade-recente">
                                    <!-- Itens serão adicionados via JS -->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="bi bi-bar-chart me-2"></i>Manutenções por Tipo de Equipamento
                            </div>
                            <div class="card-body" id="grafico-tipos" style="min-height: 300px;">
                                <!-- Gráfico será adicionado via JS -->
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="bi bi-pie-chart me-2"></i>Manutenções por Categoria
                            </div>
                            <div class="card-body" id="grafico-categorias" style="min-height: 300px;">
                                <!-- Gráfico será adicionado via JS -->
                            </div>
                        </div>
                    </div>
                </div>
                 <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="bi bi-clock-history me-2"></i>Tempo Médio de Manutenção
                            </div>
                           <div class="card-body" id="grafico-tempo-medio" style="min-height: 300px;">
                               <!-- Gráfico será adicionado via JS -->
                           </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="bi bi-calendar-check me-2"></i>Manutenções por Período
                            </div>
                            <div class="card-body">
                                <div class="d-flex justify-content-end mb-3">
                                    <select id="filtro-periodo-grafico" class="form-select form-select-sm" style="width: auto;">
                                        <option value="7">Últimos 7 dias</option>
                                        <option value="30" selected>Últimos 30 dias</option>
                                        <option value="90">Últimos 90 dias</option>
                                        <option value="365">Último ano</option>
                                    </select>
                                </div>
                                <div id="grafico-periodo" style="min-height: 250px;">
                                    <!-- Gráfico será adicionado via JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <i class="bi bi-truck me-2"></i>Status dos Equipamentos
                    </div>
                    <div class="card-body">
                        <div class="row" id="status-equipamentos">
                            <!-- Status serão adicionados via JS -->
                        </div>
                    </div>
                </div>

            </div> <!-- Fim tela-dashboard -->

            <!-- Tela Lista -->
            <div id="tela-lista" class="view-content" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2"> <!-- Flex-wrap para mobile -->
                    <h2>Lista de Manutenções</h2>
                    <button class="btn btn-primary" id="btn-nova-manutencao">
                        <i class="bi bi-plus-circle me-1"></i>Nova Manutenção
                    </button>
                </div>

                <div class="card mb-4">
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-3 col-sm-6">
                                <label for="filtro-status" class="form-label visually-hidden">Status</label> <!-- Label para acessibilidade -->
                                <select class="form-select" id="filtro-status" aria-label="Filtrar por Status">
                                    <option value="">Todos os Status</option>
                                    <option value="Aguardando Manutenção">Aguardando</option>
                                    <option value="Em Manutenção">Em Manutenção</option>
                                    <option value="Manutenção Concluída">Concluídas</option>
                                    <option value="Equipamento Disponível">Disponíveis</option>
                                </select>
                            </div>
                            <div class="col-md-3 col-sm-6">
                               <label for="filtro-placa" class="form-label visually-hidden">Placa</label>
                                <input type="text" class="form-control" id="filtro-placa" placeholder="Filtrar por Placa" aria-label="Filtrar por Placa">
                            </div>
                            <div class="col-md-3 col-sm-6">
                                <button class="btn btn-primary w-100" id="btn-filtrar">
                                    <i class="bi bi-search me-1"></i>Filtrar
                                </button>
                            </div>
                            <div class="col-md-3 col-sm-6">
                                <button class="btn btn-outline-secondary w-100" id="btn-limpar-filtro">
                                    <i class="bi bi-x-circle me-1"></i>Limpar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Placa</th>
                                        <th>Tipo</th>
                                        <th>Data</th>
                                        <th>Status</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="lista-manutencoes">
                                    <!-- Linhas serão adicionadas via JS -->
                                </tbody>
                            </table>
                        </div>
                        <div id="sem-registros" class="text-center py-4" style="display: none;">
                            <i class="bi bi-exclamation-circle fs-1 text-muted"></i>
                            <p class="mt-2 text-muted">Nenhum registro encontrado</p>
                        </div>
                    </div>
                </div>
            </div> <!-- Fim tela-lista -->

            <!-- Tela Pré-Manutenção -->
            <div id="tela-pre-manutencao" class="view-content" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
                    <h2>Registro de Pré-Manutenção</h2>
                    <button class="btn btn-outline-secondary btn-voltar">
                        <i class="bi bi-arrow-left me-1"></i>Voltar para Lista
                    </button>
                </div>

                <form id="form-pre-manutencao" novalidate> <!-- novalidate para usar validação customizada -->
                    <input type="hidden" id="pre-id" name="id">

                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-truck me-2"></i>Informações do Equipamento
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="pre-tipo-equipamento" class="form-label">Tipo de Equipamento*</label>
                                    <select class="form-select" id="pre-tipo-equipamento" name="tipoEquipamento" required>
                                        <option value="">Selecione...</option>
                                        <!-- Opções preenchidas via JS -->
                                    </select>
                                     <div class="invalid-feedback">Por favor, selecione o tipo de equipamento.</div>
                                </div>
                                <div class="col-md-6">
                                    <label for="pre-placa-select" class="form-label">Equipamento/Placa*</label>
                                    <select class="form-select" id="pre-placa-select" style="display: none;" aria-describedby="placaValidationFeedback">
                                        <option value="">Selecione o Equipamento...</option>
                                        <!-- Opções preenchidas via JS -->
                                    </select>
                                    <input type="text" class="form-control mt-2" id="pre-placa-outro-valor" style="display: none;" placeholder="Digite a placa ou nome" aria-describedby="placaValidationFeedback">
                                    <div id="placaValidationFeedback" class="invalid-feedback">Por favor, selecione ou informe o equipamento/placa.</div>
                                    <input type="hidden" id="pre-placa" name="placa" required>
                                    <input type="hidden" id="pre-modelo" name="modelo">
                                </div>
                            </div>
                        </div>
                    </div> <!-- Fim card equipamento -->

                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-exclamation-triangle me-2"></i>Detalhes do Problema
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="pre-categoria-problema" class="form-label">Categoria do Problema*</label>
                                    <select class="form-select" id="pre-categoria-problema" name="categoriaProblema" required>
                                        <option value="">Selecione...</option>
                                        <!-- Opções preenchidas via JS -->
                                    </select>
                                     <div class="invalid-feedback">Por favor, selecione a categoria do problema.</div>
                                </div>
                                <div class="col-md-6">
                                    <label for="pre-urgencia" class="form-label">Urgência*</label>
                                    <select class="form-select" id="pre-urgencia" name="urgencia" required>
                                        <option value="">Selecione...</option>
                                        <!-- Opções preenchidas via JS -->
                                    </select>
                                     <div class="invalid-feedback">Por favor, selecione o nível de urgência.</div>
                                </div>
                                <div class="col-12" id="motivo-outro-container" style="display: none;">
                                    <label for="pre-motivo-outro" class="form-label">Especifique o Problema*</label>
                                    <input type="text" class="form-control" id="pre-motivo-outro" name="motivoOutro"> <!-- required é setado via JS -->
                                    <div class="invalid-feedback">Por favor, especifique o problema.</div>
                                </div>
                                <div class="col-12">
                                    <label for="pre-descricao-problema" class="form-label">Descrição do Problema*</label>
                                    <textarea class="form-control" id="pre-descricao-problema" name="descricaoProblema" rows="3" required></textarea>
                                    <div class="invalid-feedback">Por favor, descreva o problema encontrado.</div>
                                </div>
                            </div>
                        </div>
                    </div> <!-- Fim card problema -->

                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-check-square me-2"></i>Checklist Pré-Manutenção
                        </div>
                        <div class="card-body">
                            <div id="pre-checklist-container">
                                <!-- Checklist gerado via JS -->
                            </div>
                            <div class="mb-3 mt-3"> <!-- Adicionado mt-3 -->
                                <label for="pre-observacoes" class="form-label">Observações Adicionais</label>
                                <textarea class="form-control" id="pre-observacoes" name="observacoesPre" rows="3"></textarea>
                            </div>
                        </div>
                    </div> <!-- Fim card checklist pre -->

                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-camera me-2"></i>Registro Fotográfico
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="d-flex gap-2 mb-3 flex-wrap">
                                    <button type="button" class="btn btn-primary" id="btn-abrir-camera-pre">
                                        <i class="bi bi-camera-fill me-1"></i>Abrir Câmera
                                    </button>
                                    <label class="btn btn-outline-secondary" for="input-imagem-pre"> <!-- Usar label para estilizar -->
                                        <i class="bi bi-image me-1"></i>Da Galeria
                                    </label>
                                    <input type="file" id="input-imagem-pre" accept="image/*" multiple style="display: none;">
                                </div>

                                <div id="camera-container-pre" class="camera-container" style="display: none;">
                                    <video id="camera-preview-pre" autoplay playsinline></video>
                                    <div class="camera-controls">
                                        <button type="button" class="btn btn-primary" id="btn-capturar-pre">
                                            <i class="bi bi-camera-fill me-1"></i>Capturar
                                        </button>
                                        <button type="button" class="btn btn-danger" id="btn-fechar-camera-pre">
                                            <i class="bi bi-x-circle me-1"></i>Fechar
                                        </button>
                                    </div>
                                </div>

                                <div id="imagens-preview-pre" class="d-flex flex-wrap gap-2 mt-3 border p-2 rounded bg-light" style="min-height: 100px;">
                                    <!-- Imagens serão adicionadas via JS -->
                                     <small class="text-muted w-100 text-center" id="imagens-preview-pre-placeholder" style="display: block;">Nenhuma imagem adicionada.</small> <!-- Placeholder -->
                                </div>
                            </div>
                        </div>
                    </div> <!-- Fim card fotos pre -->

                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-person me-2"></i>Responsável pelo Registro
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="pre-responsavel" class="form-label">Nome do Responsável*</label>
                                <input type="text" class="form-control" id="pre-responsavel" name="responsavel" required>
                                <div class="invalid-feedback">Por favor, informe o nome do responsável.</div>
                            </div>
                        </div>
                    </div> <!-- Fim card responsável -->

                    <div class="d-flex justify-content-between mb-4">
                        <button type="button" class="btn btn-outline-secondary btn-voltar">
                            <i class="bi bi-arrow-left me-1"></i>Cancelar
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-save me-1"></i>Salvar e Avançar
                        </button>
                    </div>
                </form>
            </div> <!-- Fim tela-pre-manutencao -->

            <!-- Tela Pós-Manutenção -->
            <div id="tela-pos-manutencao" class="view-content" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
                    <h2>Registro de Pós-Manutenção</h2>
                    <!-- Removido botão voltar padrão, usar o botão específico abaixo -->
                </div>

                <form id="form-pos-manutencao" novalidate>
                    <input type="hidden" id="pos-id" name="id">

                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-truck me-2"></i>Resumo do Equipamento
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <p class="form-label mb-1 fw-bold">Placa/Equipamento</p> <!-- Label em negrito -->
                                    <p class="form-control-plaintext ps-0" id="pos-placa-display"></p>
                                </div>
                                <div class="col-md-6">
                                    <p class="form-label mb-1 fw-bold">Tipo de Equipamento</p>
                                    <p class="form-control-plaintext ps-0" id="pos-tipo-display"></p>
                                </div>
                            </div>
                        </div>
                    </div> <!-- Fim card resumo -->

                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-check-square me-2"></i>Checklist Pós-Manutenção
                        </div>
                        <div class="card-body">
                            <div id="pos-checklist-container">
                                <!-- Checklist gerado via JS -->
                            </div>
                            <div class="mb-3 mt-3">
                                <label for="pos-observacoes" class="form-label">Observações da Manutenção</label>
                                <textarea class="form-control" id="pos-observacoes" name="observacoesPos" rows="3"></textarea>
                            </div>
                        </div>
                    </div> <!-- Fim card checklist pos -->

                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-camera me-2"></i>Registro Fotográfico Pós-Manutenção
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="d-flex gap-2 mb-3 flex-wrap">
                                    <button type="button" class="btn btn-primary" id="btn-abrir-camera-pos">
                                        <i class="bi bi-camera-fill me-1"></i>Abrir Câmera
                                    </button>
                                     <label class="btn btn-outline-secondary" for="input-imagem-pos">
                                        <i class="bi bi-image me-1"></i>Da Galeria
                                    </label>
                                    <input type="file" id="input-imagem-pos" accept="image/*" multiple style="display: none;">
                                </div>

                                <div id="camera-container-pos" class="camera-container" style="display: none;">
                                    <video id="camera-preview-pos" autoplay playsinline></video>
                                    <div class="camera-controls">
                                        <button type="button" class="btn btn-primary" id="btn-capturar-pos">
                                            <i class="bi bi-camera-fill me-1"></i>Capturar
                                        </button>
                                        <button type="button" class="btn btn-danger" id="btn-fechar-camera-pos">
                                            <i class="bi bi-x-circle me-1"></i>Fechar
                                        </button>
                                    </div>
                                </div>

                                <div id="imagens-preview-pos" class="d-flex flex-wrap gap-2 mt-3 border p-2 rounded bg-light" style="min-height: 100px;">
                                    <!-- Imagens serão adicionadas via JS -->
                                     <small class="text-muted w-100 text-center" id="imagens-preview-pos-placeholder" style="display: block;">Nenhuma imagem adicionada.</small> <!-- Placeholder -->
                                </div>
                            </div>
                        </div>
                    </div> <!-- Fim card fotos pos -->

                    <div class="d-flex justify-content-between mb-4 flex-wrap gap-2"> <!-- Flex-wrap para mobile -->
                        <button type="button" class="btn btn-outline-secondary" id="btn-voltar-pre">
                            <i class="bi bi-arrow-left me-1"></i>Voltar para Pré-Manutenção
                        </button>
                        <button type="submit" class="btn btn-success">
                            <i class="bi bi-check-circle me-1"></i>Finalizar Manutenção
                        </button>
                    </div>
                </form>
            </div> <!-- Fim tela-pos-manutencao -->

            <!-- Tela Visualização -->
            <div id="tela-visualizacao" class="view-content" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
                    <h2>Detalhes da Manutenção</h2>
                    <div class="btn-group flex-wrap gap-1"> <!-- Gap entre botões -->
                        <button class="btn btn-outline-secondary btn-voltar">
                            <i class="bi bi-arrow-left me-1"></i>Voltar para Lista
                        </button>
                        <button class="btn btn-outline-primary" id="btn-editar-manutencao">
                            <i class="bi bi-pencil me-1"></i>Editar
                        </button>
                         <div class="dropdown d-inline-block">
                          <button class="btn btn-outline-info dropdown-toggle" type="button" id="btnRelatorioOpcoes" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-file-earmark-arrow-down me-1"></i>Relatórios
                          </button>
                          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="btnRelatorioOpcoes"> <!-- dropdown-menu-end para alinhar à direita -->
                            <li><a class="dropdown-item" href="#" id="btn-gerar-pdf-basico"><i class="bi bi-file-pdf me-2"></i>Relatório PDF Básico</a></li>
                            <li><a class="dropdown-item" href="#" id="btn-gerar-pdf-avancado"><i class="bi bi-file-earmark-pdf me-2"></i>Relatório PDF Avançado</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" id="btn-gerar-excel"><i class="bi bi-file-earmark-excel me-2"></i>Exportar para Excel</a></li>
                            <li><a class="dropdown-item" href="#" id="btn-gerar-csv"><i class="bi bi-file-earmark-spreadsheet me-2"></i>Exportar para CSV</a></li>
                          </ul>
                        </div>
                    </div>
                </div>

                <div id="detalhes-manutencao">
                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-info-circle me-2"></i>Informações Gerais
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3 col-sm-6 mb-3"> <!-- Ajuste colunas mobile -->
                                    <h6 class="text-muted mb-1">ID</h6>
                                    <p id="view-id" class="fw-bold"></p> <!-- Negrito para destaque -->
                                </div>
                                <div class="col-md-3 col-sm-6 mb-3">
                                    <h6 class="text-muted mb-1">Data de Abertura</h6>
                                    <p id="view-data-criacao"></p>
                                </div>
                                <div class="col-md-3 col-sm-6 mb-3">
                                    <h6 class="text-muted mb-1">Status</h6>
                                    <p><span class="badge fs-6" id="view-status"></span></p> <!-- Aumenta fonte badge -->
                                </div>
                                <div class="col-md-3 col-sm-6 mb-3">
                                    <h6 class="text-muted mb-1">Responsável</h6>
                                    <p id="view-responsavel"></p>
                                </div>
                            </div>
                            <hr class="my-3"> <!-- Ajusta margem hr -->
                             <div class="row">
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-muted mb-1">Placa/Equipamento</h6>
                                    <p id="view-placa"></p>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-muted mb-1">Tipo de Equipamento</h6>
                                    <p id="view-tipo-equipamento"></p>
                                </div>
                             </div>
                        </div>
                    </div> <!-- Fim card geral -->

                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-exclamation-triangle me-2"></i>Detalhes do Problema
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-muted mb-1">Categoria</h6>
                                    <p id="view-categoria-problema"></p>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-muted mb-1">Urgência</h6>
                                    <p id="view-urgencia"></p>
                                </div>
                            </div>
                            <div class="row mb-3" id="view-motivo-outro-container" style="display: none;">
                                <div class="col-12">
                                    <h6 class="text-muted mb-1">Especificação do Problema (Outro)</h6>
                                    <p id="view-motivo-outro" class="fst-italic"></p> <!-- Itálico para destaque -->
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <h6 class="text-muted mb-1">Descrição Detalhada</h6>
                                    <p id="view-descricao-problema" style="white-space: pre-wrap;"></p>
                                </div>
                            </div>
                        </div>
                    </div> <!-- Fim card problema -->

                    <!-- Abas para Pré e Pós -->
                    <div class="card mb-4">
                        <div class="card-header">
                             <ul class="nav nav-tabs card-header-tabs" id="registroTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="pre-tab" data-bs-toggle="tab" data-bs-target="#pre-tab-pane" type="button" role="tab" aria-controls="pre-tab-pane" aria-selected="true">
                                        <i class="bi bi-clipboard-check me-1"></i>Pré-Manutenção
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                     <button class="nav-link" id="pos-tab" data-bs-toggle="tab" data-bs-target="#pos-tab-pane" type="button" role="tab" aria-controls="pos-tab-pane" aria-selected="false" disabled> <!-- Começa desabilitada -->
                                         <i class="bi bi-clipboard-check me-1"></i>Pós-Manutenção
                                     </button>
                                </li>
                            </ul>
                        </div>
                        <div class="card-body tab-content" id="registroTabsContent">
                            <!-- Aba Pré-Manutenção -->
                            <div class="tab-pane fade show active" id="pre-tab-pane" role="tabpanel" aria-labelledby="pre-tab" tabindex="0">
                                <h5 class="mb-3"><i class="bi bi-list-check me-2"></i>Checklist Pré-Manutenção</h5>
                                <div id="view-checklist-pre" class="mb-4">
                                    <!-- Checklist preenchido via JS -->
                                </div>
                                <hr>
                                <h5 class="mb-2"><i class="bi bi-chat-left-text me-2"></i>Observações</h5>
                                <p id="view-observacoes-pre" class="mb-4 text-muted" style="white-space: pre-wrap;"></p>
                                <hr>
                                <h5 class="mb-2"><i class="bi bi-images me-2"></i>Imagens</h5>
                                <div id="view-imagens-pre" class="d-flex flex-wrap gap-2 bg-light p-2 rounded">
                                    <!-- Imagens preenchidas via JS -->
                                </div>
                            </div>
                            <!-- Aba Pós-Manutenção -->
                            <div class="tab-pane fade" id="pos-tab-pane" role="tabpanel" aria-labelledby="pos-tab" tabindex="0">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <h6 class="mb-1">Data da Manutenção</h6>
                                        <p id="view-data-manutencao"></p>
                                    </div>
                                </div>
                                <hr>
                                <h5 class="mb-3"><i class="bi bi-list-check me-2"></i>Checklist Pós-Manutenção</h5>
                                <div id="view-checklist-pos" class="mb-4">
                                    <!-- Checklist preenchido via JS -->
                                </div>
                                <hr>
                                <h5 class="mb-2"><i class="bi bi-chat-left-text me-2"></i>Observações</h5>
                                <p id="view-observacoes-pos" class="mb-4 text-muted" style="white-space: pre-wrap;"></p>
                                <hr>
                                <h5 class="mb-2"><i class="bi bi-images me-2"></i>Imagens</h5>
                                <div id="view-imagens-pos" class="d-flex flex-wrap gap-2 bg-light p-2 rounded">
                                    <!-- Imagens preenchidas via JS -->
                                </div>
                            </div>
                        </div>
                    </div><!-- Fim Card Abas Pré/Pós -->


                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-arrow-repeat me-2"></i>Atualizar Status da Manutenção
                        </div>
                        <div class="card-body">
                            <div class="d-flex gap-2 flex-wrap justify-content-center"> <!-- Centraliza botões -->
                                <button class="btn btn-outline-warning btn-status flex-grow-1" data-status="Aguardando Manutenção">
                                    <i class="bi bi-hourglass-split me-1"></i>Aguardando
                                </button>
                                <button class="btn btn-outline-primary btn-status flex-grow-1" data-status="Em Manutenção">
                                    <i class="bi bi-tools me-1"></i>Em Manutenção
                                </button>
                                <button class="btn btn-outline-success btn-status flex-grow-1" data-status="Manutenção Concluída">
                                    <i class="bi bi-check-circle-fill me-1"></i>Concluído
                                </button>
                                <button class="btn btn-outline-info btn-status flex-grow-1" data-status="Equipamento Disponível">
                                    <i class="bi bi-check-all me-1"></i>Disponível
                                </button>
                            </div>
                        </div>
                    </div> <!-- Fim card status -->
                </div> <!-- Fim #detalhes-manutencao -->
            </div> <!-- Fim tela-visualizacao -->

            <!-- Tela Ferramentas -->
            <div id="tela-ferramentas" class="view-content" style="display: none;">
                <h2 class="mb-4">Ferramentas e Configurações</h2>

                <div class="row">
                    <!-- Card Integração Planilha -->
                    <div class="col-lg-6 mb-4">
                        <div class="card h-100 shadow-sm">
                            <div class="card-header bg-light border-bottom-0">
                                <h5 class="mb-0"><i class="bi bi-table me-2 text-primary"></i>Integração com Planilha de Turnos</h5>
                            </div>
                            <div class="card-body d-flex flex-column">
                                <p class="card-text text-muted">
                                    Transfira automaticamente os dados de equipamentos em manutenção para a planilha de controle de turnos.
                                </p>
                                <div class="mb-3">
                                    <label for="id-planilha-turnos" class="form-label">ID da Planilha de Turnos Google</label>
                                    <input type="text" class="form-control" id="id-planilha-turnos" placeholder="Cole o ID da planilha aqui">
                                    <div class="form-text">
                                        Encontre o ID na URL da planilha (entre `/d/` e `/edit`).
                                    </div>
                                </div>
                                 <div class="mt-auto"> <!-- Push content to bottom -->
                                    <button class="btn btn-primary w-100 mb-2" id="btn-executar-integracao">
                                        <i class="bi bi-arrow-repeat me-1"></i>Executar Integração Agora
                                    </button>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="integracao-automatica">
                                        <label class="form-check-label small" for="integracao-automatica">
                                            Ativar integração automática diária (aprox. 6h)
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Card Notificações por E-mail -->
                    <div class="col-lg-6 mb-4">
                        <div class="card h-100 shadow-sm">
                            <div class="card-header bg-light border-bottom-0">
                                <h5 class="mb-0"><i class="bi bi-envelope-at me-2 text-success"></i>Notificações por E-mail</h5>
                            </div>
                            <div class="card-body d-flex flex-column">
                                <p class="card-text text-muted">
                                    Configure e-mails para receber atualizações e alertas sobre manutenções importantes.
                                </p>
                                <div class="mb-3">
                                    <label for="emails-notificacao" class="form-label">E-mails para Notificação (separados por vírgula)</label>
                                    <textarea class="form-control" id="emails-notificacao" rows="2" placeholder="exemplo@dominio.com, outro@dominio.com"></textarea>
                                </div>
                                <div class="d-grid mb-3">
                                    <button class="btn btn-success" id="btn-salvar-emails">
                                        <i class="bi bi-save me-1"></i>Salvar Configuração de E-mails
                                    </button>
                                 </div>
                                <div class="mt-auto">
                                     <label for="tipo-email-teste" class="form-label small">Enviar e-mail de teste:</label>
                                    <div class="input-group">
                                        <select class="form-select form-select-sm" id="tipo-email-teste">
                                            <option value="nova">Nova Manutenção</option>
                                            <option value="atualizacao">Atualização de Status</option>
                                            <option value="conclusao">Conclusão</option>
                                            <option value="alerta">Alerta Urgente</option>
                                        </select>
                                        <button class="btn btn-outline-secondary btn-sm" id="btn-teste-email">
                                            <i class="bi bi-send me-1"></i>Enviar Teste
                                         </button>
                                    </div>
                                    <div class="form-text small">Usa a primeira manutenção da lista para o teste.</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Card Configurações do Sistema -->
                    <div class="col-lg-6 mb-4">
                        <div class="card h-100 shadow-sm">
                             <div class="card-header bg-light border-bottom-0">
                                <h5 class="mb-0"><i class="bi bi-gear-wide-connected me-2 text-info"></i>Configurações do Sistema</h5>
                             </div>
                            <div class="card-body d-flex flex-column">
                                <p class="card-text text-muted">
                                    Gerencie tarefas automáticas e verifique a versão do sistema.
                                </p>
                                <div class="d-grid gap-2 mb-3">
                                    <button class="btn btn-info text-white" id="btn-configurar-gatilhos">
                                        <i class="bi bi-clock-history me-1"></i>(Re)Configurar Tarefas Automáticas
                                     </button>
                                    <button class="btn btn-outline-secondary" id="btn-verificar-atualizacoes">
                                        <i class="bi bi-cloud-download me-1"></i>Verificar Versão
                                    </button>
                                 </div>
                                <div class="mt-auto text-center pt-3 border-top">
                                    <span class="small text-muted">Versão Atual do Sistema:</span>
                                    <span class="badge bg-dark ms-1" id="versao-sistema">?.?.?</span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div> <!-- Fim da row -->
            </div> <!-- Fim tela-ferramentas -->

        </div> <!-- Fim #conteudo-principal -->
    </div> <!-- Fim .container -->

    <!-- Modals -->
    <div class="modal fade" id="cameraModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-camera-video me-2"></i>Capturar Imagem</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="camera-container">
                        <video id="camera-modal-preview" autoplay playsinline class="border rounded"></video> <!-- Adicionado ID correto e estilo -->
                        <canvas id="camera-canvas" style="display: none;"></canvas>
                    </div>
                    <div id="camera-error-message" class="alert alert-danger mt-2" style="display: none;"></div>
                </div>
                <div class="modal-footer justify-content-center"> <!-- Centraliza botões -->
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="bi bi-x-lg me-1"></i>Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btn-capturar-modal">
                        <i class="bi bi-camera-fill me-1"></i>Capturar Imagem
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirmModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered"> <!-- Centraliza verticalmente -->
            <div class="modal-content">
                <div class="modal-header bg-warning border-0">
                    <h5 class="modal-title"><i class="bi bi-exclamation-triangle-fill me-2"></i>Confirmação</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="confirm-message">Tem certeza que deseja realizar esta ação?</p>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-warning" id="confirm-yes">Confirmar</button> <!-- Botão confirmação amarelo -->
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="alertModal" tabindex="-1" aria-hidden="true">
         <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" id="alertModalHeader"> <!-- ID para estilização dinâmica -->
                    <h5 class="modal-title" id="alert-title">Aviso</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="alert-message" style="white-space: pre-wrap;"></p>
                </div>
                <div class="modal-footer border-0" id="alertModalFooter">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="choiceModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-success text-white border-0">
                    <h5 class="modal-title"><i class="bi bi-check-circle-fill me-2"></i>Registro Salvo</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>O registro de pré-manutenção foi salvo com sucesso!</p>
                    <p class="fw-bold">O que deseja fazer agora?</p>
                </div>
                <div class="modal-footer border-0 justify-content-center flex-wrap gap-2"> <!-- Centraliza e permite quebra -->
                    <button type="button" class="btn btn-outline-secondary" id="btn-choice-lista">
                        <i class="bi bi-list-ul me-1"></i>Ir para Lista
                    </button>
                    <button type="button" class="btn btn-outline-primary" id="btn-choice-novo">
                        <i class="bi bi-plus-circle me-1"></i>Novo Registro
                    </button>
                    <button type="button" class="btn btn-success" id="btn-choice-pos">
                        <i class="bi bi-arrow-right-circle me-1"></i>Ir para Pós-Manutenção
                    </button>
                </div>
            </div>
        </div>
    </div>

     <div class="modal fade" id="modal-anotacao" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl"> <!-- Modal extra large para mais espaço -->
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-pencil-square me-2"></i>Anotar Imagem</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                 </div>
                <div class="modal-body">
                    <!-- Container do anotador é preenchido/controlado pela classe ImageAnnotator -->
                    <div id="annotation-container">
                         <!-- Conteúdo dinâmico aqui (controles, imagem, canvas) -->
                    </div>
                </div>
                 <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btn-save-annotation"><i class="bi bi-save me-1"></i>Salvar Anotação</button>
                </div>
             </div>
        </div>
    </div>

    <footer class="footer-dev">
        </> Desenvolvido por Warlison Abreu
    </footer>

    <!-- ######################################################## -->
    <!-- #                   SCRIPTS JS                       # -->
    <!-- ######################################################## -->

    <!-- Bibliotecas Externas (Manter onde estavam ou colocar primeiro) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

    <!-- Scripts JS Modulares (Substitui o bloco monolítico removido) -->
    <!-- Ordem sugerida baseada em dependências comuns -->

    <!-- 1. Configurações e Utilitários -->
    <script src="config.js"></script>         <!-- Arquivo com constantes e configurações globais (ex: URL_API) -->
    <script src="utils-novo.js"></script>    <!-- Funções utilitárias genéricas (formatarData, etc.) -->

    <!-- 2. Módulos Core (Opcional - Descomente se existirem) -->
    <!-- <script src="state.js"></script> -->       <!-- Gerenciador de Estado Global (se houver) -->
    <!-- <script src="cacheManager.js"></script> --> <!-- Gerenciador de Cache (se houver) -->
    <!-- <script src="security.js"></script> -->     <!-- Lógica de Segurança específica (se houver) -->
    <!-- <script src="notifications.js"></script> --> <!-- Módulo de Notificações/Alertas (se separado) -->

    <!-- 3. Cliente API -->
    <script src="api-client.js"></script>    <!-- Lógica para fazer requisições ao backend (ex: apiRequest) -->

    <!-- 4. Módulos de Features Específicas -->
    <script src="image-annotator.js"></script> <!-- Classe ImageAnnotator (extraída do bloco antigo) -->
    <script src="photo-handler.js"></script> <!-- Lógica relacionada à câmera e upload de imagens -->
    <script src="form-handler.js"></script>  <!-- Lógica de manipulação e validação de formulários -->
    <script src="dashboard.js"></script>    <!-- Lógica específica do dashboard (gráficos, contadores) -->
    <!-- <script src="googleAuth.js"></script> -->  <!-- Lógica de Autenticação Google (se houver) -->

    <!-- 5. Lógica Principal e Inicialização -->
    <script src="app.js"></script>           <!-- Módulo principal que orquestra a aplicação, UI, etc. -->
    <script src="main.js"></script>          <!-- Ponto de entrada, chama a inicialização em app.js -->

    <!-- REMOVIDO: O bloco <script> gigante que continha toda a lógica JS foi removido daqui -->
    <!-- REMOVIDO: A inclusão de fix-loading.js (se existia) também foi removida conforme instrução -->

</body>
</html>
